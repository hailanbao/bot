{"remainingRequest":"F:\\developer\\mall_sys\\mall-front\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\developer\\mall_sys\\mall-front\\src\\pages\\orderPay.vue?vue&type=style&index=0&id=fd7d8404&lang=scss","dependencies":[{"path":"F:\\developer\\mall_sys\\mall-front\\src\\pages\\orderPay.vue","mtime":1698657716429},{"path":"F:\\developer\\mall_sys\\mall-front\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\developer\\mall_sys\\mall-front\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"F:\\developer\\mall_sys\\mall-front\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"F:\\developer\\mall_sys\\mall-front\\node_modules\\sass-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\developer\\mall_sys\\mall-front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\developer\\mall_sys\\mall-front\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ci5vcmRlci1wYXl7CiAgLndyYXBwZXJ7CiAgICBiYWNrZ3JvdW5kLWNvbG9yOiNGNUY1RjU7CiAgICBwYWRkaW5nLXRvcDozMHB4OwogICAgcGFkZGluZy1ib3R0b206NjFweDsKICAgIC5vcmRlci13cmFwewogICAgICBwYWRkaW5nOiA2MnB4IDUwcHg7CiAgICAgIGJhY2tncm91bmQtY29sb3I6ICNmZmY7CiAgICAgIGZvbnQtc2l6ZToxNHB4OwogICAgICBtYXJnaW4tYm90dG9tOjMwcHg7CiAgICAgIC5pdGVtLW9yZGVyewogICAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgICAgICAuaWNvbi1zdWNjewogICAgICAgICAgd2lkdGg6IDkwcHg7CiAgICAgICAgICBoZWlnaHQ6IDkwcHg7CiAgICAgICAgICBib3JkZXItcmFkaXVzOiA1MCU7CiAgICAgICAgICBiYWNrZ3JvdW5kOnVybCgnL2ltZ3MvaWNvbi1nb3UucG5nJykgIzgwYzU4YSBuby1yZXBlYXQgY2VudGVyOwogICAgICAgICAgYmFja2dyb3VuZC1zaXplOjYwcHg7CiAgICAgICAgICBtYXJnaW4tcmlnaHQ6NDBweDsKICAgICAgICB9CiAgICAgICAgLm9yZGVyLWluZm97CiAgICAgICAgICBtYXJnaW4tcmlnaHQ6IDI0OHB4OwogICAgICAgICAgaDJ7CiAgICAgICAgICAgIGZvbnQtc2l6ZToyNHB4OwogICAgICAgICAgICBjb2xvcjojMzMzMzMzOwogICAgICAgICAgICBtYXJnaW4tYm90dG9tOjIwcHg7CiAgICAgICAgICB9CiAgICAgICAgICBwewogICAgICAgICAgICBjb2xvcjojNjY2NjY2OwogICAgICAgICAgICBzcGFuewogICAgICAgICAgICAgIGNvbG9yOiNGRjY3MDA7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgLm9yZGVyLXRvdGFsewogICAgICAgICAgJj5wOmZpcnN0LWNoaWxkewogICAgICAgICAgICBtYXJnaW4tYm90dG9tOjMwcHg7CiAgICAgICAgICB9CiAgICAgICAgICBzcGFuewogICAgICAgICAgICBmb250LXNpemU6MjhweDsKICAgICAgICAgICAgY29sb3I6I0ZGNjcwMDsKICAgICAgICAgIH0KICAgICAgICAgIC5pY29uLWRvd257CiAgICAgICAgICAgIGRpc3BsYXk6aW5saW5lLWJsb2NrOwogICAgICAgICAgICB3aWR0aDoxNHB4OwogICAgICAgICAgICBoZWlnaHQ6MTBweDsKICAgICAgICAgICAgYmFja2dyb3VuZDp1cmwoJy9pbWdzL2ljb24tZG93bi5wbmcnKSBuby1yZXBlYXQgY2VudGVyOwogICAgICAgICAgICBiYWNrZ3JvdW5kLXNpemU6Y29udGFpbjsKICAgICAgICAgICAgbWFyZ2luLWxlZnQ6OXB4OwogICAgICAgICAgICB0cmFuc2l0aW9uOmFsbCAuNXM7CiAgICAgICAgICAgIGN1cnNvcjpwb2ludGVyOwogICAgICAgICAgICAmLnVwewogICAgICAgICAgICAgIHRyYW5zZm9ybTogcm90YXRlKDE4MGRlZyk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICAgIC5pY29uLXVwewogICAgICAgICAgICB0cmFuc2Zvcm06IHJvdGF0ZSgxODBkZWcpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgICAuaXRlbS1kZXRhaWx7CiAgICAgICAgYm9yZGVyLXRvcDogMXB4IHNvbGlkICNEN0Q3RDc7CiAgICAgICAgcGFkZGluZy10b3A6IDQ3cHg7CiAgICAgICAgcGFkZGluZy1sZWZ0OiAxMzBweDsKICAgICAgICBmb250LXNpemU6IDE0cHg7CiAgICAgICAgbWFyZ2luLXRvcDogNDVweDsKICAgICAgICAuaXRlbXsKICAgICAgICAgIG1hcmdpbi1ib3R0b206MTlweDsKICAgICAgICAgIC5kZXRhaWwtdGl0bGV7CiAgICAgICAgICAgIGZsb2F0OmxlZnQ7CiAgICAgICAgICAgIHdpZHRoOjEwMHB4OwogICAgICAgICAgfQogICAgICAgICAgLmRldGFpbC1pbmZvewogICAgICAgICAgICBkaXNwbGF5OmlubGluZS1ibG9jazsKICAgICAgICAgICAgaW1newogICAgICAgICAgICAgIHdpZHRoOiAzMHB4OwogICAgICAgICAgICAgIHZlcnRpY2FsLWFsaWduOiBtaWRkbGU7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KICAgIC5pdGVtLXBheXsKICAgICAgcGFkZGluZzoyNnB4IDUwcHggNzJweDsKICAgICAgYmFja2dyb3VuZC1jb2xvcjojZmZmZmZmOwogICAgICBjb2xvcjogIzMzMzMzMzsKICAgICAgaDN7CiAgICAgICAgZm9udC1zaXplOiAyMHB4OwogICAgICAgIGZvbnQtd2VpZ2h0OiAyMDA7CiAgICAgICAgY29sb3I6ICMzMzMzMzM7CiAgICAgICAgcGFkZGluZy1ib3R0b206IDI0cHg7CiAgICAgICAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkICNEN0Q3RDc7CiAgICAgICAgbWFyZ2luLWJvdHRvbTogMjZweDsKICAgICAgfQogICAgICAvLyAuZXJ3ZWltYXsKICAgICAgLy8gICAuaW1newogICAgICAvLyAgIHdpZHRoOjUwcHg7CiAgICAgIC8vICAgaGVpZ2h0OjUwcHg7CiAgICAgIC8vICAgfQogICAgICAvLyB9CiAgICAgIC5wYXktd2F5ewogICAgICAgIGZvbnQtc2l6ZToxOHB4OwogICAgICAgIC5wYXl7CiAgICAgICAgICBkaXNwbGF5OmlubGluZS1ibG9jazsKICAgICAgICAgIHdpZHRoOjE4OHB4OwogICAgICAgICAgaGVpZ2h0OjY0cHg7CiAgICAgICAgICBib3JkZXI6MXB4IHNvbGlkICNEN0Q3RDc7CiAgICAgICAgICBjdXJzb3I6cG9pbnRlcjsKICAgICAgICAgICY6bGFzdC1jaGlsZHsKICAgICAgICAgICAgbWFyZ2luLWxlZnQ6MjBweDsKICAgICAgICAgIH0KICAgICAgICAgICYuY2hlY2tlZHsKICAgICAgICAgICAgYm9yZGVyOjFweCBzb2xpZCAjRkY2NzAwOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICAucGF5LWFsaXsKICAgICAgICAgIGJhY2tncm91bmQ6dXJsKCcvaW1ncy9wYXkvaWNvbi1hbGkucG5nJykgbm8tcmVwZWF0IGNlbnRlcjsKICAgICAgICAgIGJhY2tncm91bmQtc2l6ZToxMDNweCAzOHB4OwogICAgICAgICAgbWFyZ2luLXRvcDoxOXB4OwogICAgICAgIH0KICAgICAgICAucGF5LXdlY2hhdHsKICAgICAgICAgIGJhY2tncm91bmQ6dXJsKCcvaW1ncy9wYXkvaWNvbi13ZWNoYXQucG5nJykgbm8tcmVwZWF0IGNlbnRlcjsKICAgICAgICAgIGJhY2tncm91bmQtc2l6ZToxMDNweCAzOHB4OwogICAgICAgIH0KICAgICAgfQogICAgfQogIH0KfQo="},{"version":3,"sources":["orderPay.vue"],"names":[],"mappings":";AAqTA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"orderPay.vue","sourceRoot":"src/pages","sourcesContent":["<template>\n  <div class=\"order-pay\">\n    <order-header title=\"订单支付\">\n      <template v-slot:tip>\n        <span>请谨防钓鱼链接或诈骗电话，了解更多</span>\n      </template>\n    </order-header>\n    <div class=\"wrapper\">\n      <div class=\"container\">\n        <div class=\"order-wrap\">\n          <div class=\"item-order\">\n            <div class=\"icon-succ\"></div>\n            <div class=\"order-info\">\n              <h2>订单提交成功！去付款咯～</h2>\n              <p>请在<span>{{orderOvertime}}分</span>内完成支付, 超时后将取消订单</p>\n              <p>收货信息：{{addressInfo}}</p>\n            </div>\n            <div class=\"order-total\">\n              <p>应付总额：<span>{{payment}}</span>元</p>\n              <p>订单详情<em class=\"icon-down\" :class=\"{'up':showDetail}\" @click=\"showDetail=!showDetail\"></em></p>\n            </div>\n          </div>\n          <div class=\"item-detail\" v-if=\"showDetail\">\n            <div class=\"item\">\n              <div class=\"detail-title\">订单号：</div>\n              <div class=\"detail-info theme-color\">{{orderSn}}</div>\n            </div>\n            <div class=\"item\">\n              <div class=\"detail-title\">收货信息：</div>\n              <div class=\"detail-info\">{{addressInfo}}</div>\n            </div>\n            <div class=\"item good\">\n              <div class=\"detail-title\">商品名称：</div>\n              <div class=\"detail-info\">\n                <ul>\n                  <li v-for=\"(item,index) in orderDetail\" :key=\"index\">\n                    <img v-lazy=\"item.productPic\"/>{{item.productName}}\n                  </li>\n                </ul>\n              </div>\n            </div>\n            <!-- <div class=\"item\">\n              <div class=\"detail-title\">发票信息：</div>\n              <div class=\"detail-info\">电子发票 个人</div>\n            </div> -->\n          </div>\n        </div>\n        <div class=\"item-pay\">\n          <h3>选择以下支付方式付款</h3>\n          <div class=\"pay-way\">\n            <p>支付平台</p>\n            <div class=\"pay pay-ali\" @click=\"paySubmit(1)\" :class=\"{'checked':payType==1}\"></div>\n            <div class=\"erweima\">\n              <img src=\"/imgs/erweima.png\" style=\"width: 25%; height: 25%;\">\n            </div>\n            <div class=\"pay pay-wechat\" :class=\"{'checked':payType==2}\" ></div>\n          </div>\n           <div class=\"pay-way\"  v-if=\"showPay && payType==1\" >\n              <img  :src=\"payImageQr\"/>\n            </div>\n        </div>\n      </div>\n    </div>\n    <scan-pay-code v-if=\"showPay && payType==2\" @close=\"closePayModal\" :img=\"payImg\"></scan-pay-code>\n    <modal\n      title=\"支付确认\"\n      btnType=\"3\"\n      :showModal=\"showPayModal\"\n      sureText=\"查看订单\"\n      cancelText=\"未支付\"\n      @cancel=\"showPayModal=false\"\n      @submit=\"goOrderList\"\n    >\n      <template v-slot:body>\n        <p>您确认是否完成支付？</p>\n      </template>\n    </modal>\n  </div>\n</template>\n<script>\nimport QRCode from 'qrcode'\nimport OrderHeader from './../components/OrderHeader'\nimport ScanPayCode from './../components/ScanPayCode'\nimport Modal from './../components/Modal'\nimport Qs from 'qs'\nexport default{\n  name:'order-pay',\n  data(){\n    return {\n      orderId:this.$route.query.orderId,\n      addressInfo:'',//收货人地址\n      orderDetail:[],//订单详情，包含商品列表\n      showDetail:false,//是否显示订单详情\n      payType:'',//支付类型\n      showPay:false,//是否显示微信支付弹框\n      payImg:'',//微信支付的二维码地址\n      showPayModal:false,//是否显示二次支付确认弹框\n      payment:0,//订单总金额\n      T:'',//定时器ID\n      payImageQr:'', \n      orderSn:'',\n      orderOvertime:'',\n    }\n  },\n  components:{\n    OrderHeader,\n    ScanPayCode,\n    Modal\n  },\n  mounted(){\n    this.getOrderDetail();\n  },\n  methods:{\n    getOrderDetail(){\n      this.axios.get(`/order/orderDetail?orderId=${this.orderId}`).then((res)=>{\n         this.orderDetail=res.orderItemList;  //订单商品详情\n         this.addressInfo=res.receiverProvince+res.receiverCity+res.receiverRegion+res.receiverDetailAddress;\n         this.payment=res.payAmount;\n         this.orderSn=res.orderSn;\n         this.orderOvertime=res.normalOrderOvertime;\n\n      }) \n    },\n    paySubmit(payType){\n      this.payType=payType;\n      this.showPay = !this.showPay;\n      // 支付宝\n      if(payType == 1){ \n          this.axios.post('/order/tradeQrCode',Qs.stringify({\n          orderId:this.orderId,\n          payType:1\n        }),{headers: {'Content-Type': 'application/x-www-form-urlencoded'}}).then((res)=>{\n        this.payImageQr='http://localhost:8888'+res;\n        window.console.log(res);\n        })\n      }else{\n        // 微信\n        this.axios.post('/pay',{\n          orderId:this.orderId,\n          orderName:'商城基础版',\n          amount:0.01,//单位元\n          payType:2 //1支付宝，2微信\n        }).then((res)=>{\n          QRCode.toDataURL(res.content)\n          .then(url => {\n            this.showPay = true;\n            this.payImg = url;\n            this.loopOrderState();\n          })\n          .catch(() => {\n            this.$message.error('微信二维码生成失败，请稍后重试');\n          })\n        })\n      }\n    },\n    // 关闭微信弹框\n    closePayModal(){\n      this.showPay = false;\n      this.showPayModal = true;\n      clearInterval(this.T);\n    },\n    // 轮询当前订单支付状态\n    loopOrderState(){\n      this.T = setInterval(()=>{\n        this.axios.get(`/orders/${this.orderId}`).then((res)=>{\n          if(res.status == 20){\n            clearInterval(this.T);\n            this.goOrderList();\n          }\n        })\n      },1000);\n    },\n    goOrderList(){\n      this.$router.push('/order/list');\n    }\n  }\n}\n</script>\n<style lang=\"scss\">\n  .order-pay{\n    .wrapper{\n      background-color:#F5F5F5;\n      padding-top:30px;\n      padding-bottom:61px;\n      .order-wrap{\n        padding: 62px 50px;\n        background-color: #fff;\n        font-size:14px;\n        margin-bottom:30px;\n        .item-order{\n          display: flex;\n          align-items: center;\n          .icon-succ{\n            width: 90px;\n            height: 90px;\n            border-radius: 50%;\n            background:url('/imgs/icon-gou.png') #80c58a no-repeat center;\n            background-size:60px;\n            margin-right:40px;\n          }\n          .order-info{\n            margin-right: 248px;\n            h2{\n              font-size:24px;\n              color:#333333;\n              margin-bottom:20px;\n            }\n            p{\n              color:#666666;\n              span{\n                color:#FF6700;\n              }\n            }\n          }\n          .order-total{\n            &>p:first-child{\n              margin-bottom:30px;\n            }\n            span{\n              font-size:28px;\n              color:#FF6700;\n            }\n            .icon-down{\n              display:inline-block;\n              width:14px;\n              height:10px;\n              background:url('/imgs/icon-down.png') no-repeat center;\n              background-size:contain;\n              margin-left:9px;\n              transition:all .5s;\n              cursor:pointer;\n              &.up{\n                transform: rotate(180deg);\n              }\n            }\n            .icon-up{\n              transform: rotate(180deg);\n            }\n          }\n        }\n        .item-detail{\n          border-top: 1px solid #D7D7D7;\n          padding-top: 47px;\n          padding-left: 130px;\n          font-size: 14px;\n          margin-top: 45px;\n          .item{\n            margin-bottom:19px;\n            .detail-title{\n              float:left;\n              width:100px;\n            }\n            .detail-info{\n              display:inline-block;\n              img{\n                width: 30px;\n                vertical-align: middle;\n              }\n            }\n          }\n        }\n      }\n      .item-pay{\n        padding:26px 50px 72px;\n        background-color:#ffffff;\n        color: #333333;\n        h3{\n          font-size: 20px;\n          font-weight: 200;\n          color: #333333;\n          padding-bottom: 24px;\n          border-bottom: 1px solid #D7D7D7;\n          margin-bottom: 26px;\n        }\n        // .erweima{\n        //   .img{\n        //   width:50px;\n        //   height:50px;\n        //   }\n        // }\n        .pay-way{\n          font-size:18px;\n          .pay{\n            display:inline-block;\n            width:188px;\n            height:64px;\n            border:1px solid #D7D7D7;\n            cursor:pointer;\n            &:last-child{\n              margin-left:20px;\n            }\n            &.checked{\n              border:1px solid #FF6700;\n            }\n          }\n          .pay-ali{\n            background:url('/imgs/pay/icon-ali.png') no-repeat center;\n            background-size:103px 38px;\n            margin-top:19px;\n          }\n          .pay-wechat{\n            background:url('/imgs/pay/icon-wechat.png') no-repeat center;\n            background-size:103px 38px;\n          }\n        }\n      }\n    }\n  }\n</style>"]}]}