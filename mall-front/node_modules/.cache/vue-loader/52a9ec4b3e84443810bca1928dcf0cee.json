{"remainingRequest":"F:\\developer\\mall_sys\\mall-front\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\developer\\mall_sys\\mall-front\\src\\pages\\cart.vue?vue&type=style&index=0&id=741505a4&lang=scss","dependencies":[{"path":"F:\\developer\\mall_sys\\mall-front\\src\\pages\\cart.vue","mtime":1617177439000},{"path":"F:\\developer\\mall_sys\\mall-front\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\developer\\mall_sys\\mall-front\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"F:\\developer\\mall_sys\\mall-front\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"F:\\developer\\mall_sys\\mall-front\\node_modules\\sass-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\developer\\mall_sys\\mall-front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\developer\\mall_sys\\mall-front\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ci5jYXJ0ewogIC53cmFwcGVyewogICAgYmFja2dyb3VuZC1jb2xvcjojRjVGNUY1OwogICAgcGFkZGluZy10b3A6MzBweDsKICAgIHBhZGRpbmctYm90dG9tOjExNHB4OwogICAgLmNhcnQtYm94ewogICAgICBiYWNrZ3JvdW5kLWNvbG9yOiNmZmY7CiAgICAgIGZvbnQtc2l6ZToxNHB4OwogICAgICBjb2xvcjojOTk5OTk5OwogICAgICB0ZXh0LWFsaWduOmNlbnRlcjsKICAgICAgLmNoZWNrYm94ewogICAgICAgIGRpc3BsYXk6IGlubGluZS1ibG9jazsKICAgICAgICB3aWR0aDogMjJweDsKICAgICAgICBoZWlnaHQ6IDIycHg7CiAgICAgICAgYm9yZGVyOiAxcHggc29saWQgI0U1RTVFNTsKICAgICAgICB2ZXJ0aWNhbC1hbGlnbjogbWlkZGxlOwogICAgICAgIG1hcmdpbi1yaWdodDogMTdweDsKICAgICAgICBjdXJzb3I6cG9pbnRlcjsKICAgICAgICAmLmNoZWNrZWR7CiAgICAgICAgICBiYWNrZ3JvdW5kOnVybCgnL2ltZ3MvaWNvbi1nb3UucG5nJykgI0ZGNjYwMCBuby1yZXBlYXQgY2VudGVyOwogICAgICAgICAgYmFja2dyb3VuZC1zaXplOjE2cHggMTJweDsKICAgICAgICAgIGJvcmRlcjpub25lOwogICAgICAgIH0KICAgICAgfQogICAgICAuY2FydC1pdGVtLWhlYWR7CiAgICAgICAgZGlzcGxheTpmbGV4OwogICAgICAgIGhlaWdodDogNzlweDsKICAgICAgICBsaW5lLWhlaWdodDogNzlweDsKICAgICAgICAuY29sLTF7CiAgICAgICAgICBmbGV4OjE7CiAgICAgICAgfQogICAgICAgIC5jb2wtMnsKICAgICAgICAgIGZsZXg6MjsKICAgICAgICB9CiAgICAgICAgLmNvbC0zewogICAgICAgICAgZmxleDozOwogICAgICAgIH0KICAgICAgfQogICAgICAuY2FydC1pdGVtLWxpc3R7CiAgICAgICAgLmNhcnQtaXRlbXsKICAgICAgICAgIGRpc3BsYXk6ZmxleDsKICAgICAgICAgIGFsaWduLWl0ZW1zOmNlbnRlcjsKICAgICAgICAgIGhlaWdodDoxMjVweDsKICAgICAgICAgIGJvcmRlci10b3A6MXB4IHNvbGlkICNFNUU1RTU7CiAgICAgICAgICBmb250LXNpemU6MTZweDsKICAgICAgICAgIC5pdGVtLWNoZWNrewogICAgICAgICAgICBmbGV4OjE7CiAgICAgICAgICB9CiAgICAgICAgICAuaXRlbS1uYW1lewogICAgICAgICAgICBmbGV4OjM7CiAgICAgICAgICAgIGZvbnQtc2l6ZTogMThweDsKICAgICAgICAgICAgY29sb3I6ICMzMzMzMzM7CiAgICAgICAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgICAgICAgICAgIGltZ3sKICAgICAgICAgICAgICB3aWR0aDo4MHB4OwogICAgICAgICAgICAgIGhlaWdodDo4MHB4OwogICAgICAgICAgICAgIHZlcnRpY2FsLWFsaWduOm1pZGRsZTsKICAgICAgICAgICAgfQogICAgICAgICAgICBzcGFuewogICAgICAgICAgICAgIG1hcmdpbi1sZWZ0OiAzMHB4OwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICAuaXRlbS1wcmljZXsKICAgICAgICAgICAgZmxleDoxOwogICAgICAgICAgICBjb2xvcjojMzMzMzMzOwogICAgICAgICAgfQogICAgICAgICAgLml0ZW0tbnVtewogICAgICAgICAgICBmbGV4OjI7CiAgICAgICAgICAgIC5udW0tYm94ewogICAgICAgICAgICAgIGRpc3BsYXk6aW5saW5lLWJsb2NrOwogICAgICAgICAgICAgIHdpZHRoOjE1MHB4OwogICAgICAgICAgICAgIGhlaWdodDo0MHB4OwogICAgICAgICAgICAgIGxpbmUtaGVpZ2h0OjQwcHg7CiAgICAgICAgICAgICAgYm9yZGVyOjFweCBzb2xpZCAjRTVFNUU1OwogICAgICAgICAgICAgIGZvbnQtc2l6ZToxNHB4OwogICAgICAgICAgICAgIGF7CiAgICAgICAgICAgICAgICBkaXNwbGF5OmlubGluZS1ibG9jazsKICAgICAgICAgICAgICAgIHdpZHRoOjUwcHg7CiAgICAgICAgICAgICAgICBjb2xvcjojMzMzMzMzOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBzcGFuewogICAgICAgICAgICAgICAgZGlzcGxheTppbmxpbmUtYmxvY2s7CiAgICAgICAgICAgICAgICB3aWR0aDo1MHB4OwogICAgICAgICAgICAgICAgY29sb3I6IzMzMzMzMzsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICAgIC5pdGVtLXRvdGFsewogICAgICAgICAgICBmbGV4OjE7CiAgICAgICAgICAgIGNvbG9yOiNGRjY2MDA7CiAgICAgICAgICB9CiAgICAgICAgICAuaXRlbS1kZWx7CiAgICAgICAgICAgIGZsZXg6MTsKICAgICAgICAgICAgd2lkdGg6MTRweDsKICAgICAgICAgICAgaGVpZ2h0OjEycHg7CiAgICAgICAgICAgIGJhY2tncm91bmQ6dXJsKCcvaW1ncy9pY29uLWNsb3NlLnBuZycpIG5vLXJlcGVhdCBjZW50ZXI7CiAgICAgICAgICAgIGJhY2tncm91bmQtc2l6ZTpjb250YWluOwogICAgICAgICAgICBjdXJzb3I6cG9pbnRlcjsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KICAgIC5vcmRlci13cmFwewogICAgICBmb250LXNpemU6MTRweDsKICAgICAgY29sb3I6ICM2NjY2NjY7CiAgICAgIG1hcmdpbi10b3A6IDIwcHg7CiAgICAgIGhlaWdodDogNTBweDsKICAgICAgbGluZS1oZWlnaHQ6IDUwcHg7CiAgICAgIC5jYXJ0LXRpcHsKICAgICAgICBtYXJnaW4tbGVmdDogMjlweDsKICAgICAgICBhewogICAgICAgICAgY29sb3I6ICM2NjY2NjY7CiAgICAgICAgICBtYXJnaW4tcmlnaHQ6MzdweDsKICAgICAgICB9CiAgICAgICAgc3BhbnsKICAgICAgICAgIGNvbG9yOiNGRjY2MDA7CiAgICAgICAgICBtYXJnaW46MCA1cHg7CiAgICAgICAgfQogICAgICB9CiAgICAgIC50b3RhbHsKICAgICAgICBmb250LXNpemU6MTRweDsKICAgICAgICBjb2xvcjojRkY2NjAwOwogICAgICAgIHNwYW57CiAgICAgICAgICBmb250LXNpemU6MjRweDsKICAgICAgICB9CiAgICAgICAgYXsKICAgICAgICAgIHdpZHRoOjIwMnB4OwogICAgICAgICAgaGVpZ2h0OjUwcHg7CiAgICAgICAgICBsaW5lLWhlaWdodDo1MHB4OwogICAgICAgICAgZm9udC1zaXplOjE4cHg7CiAgICAgICAgICBtYXJnaW4tbGVmdDozN3B4OwogICAgICAgIH0KICAgICAgfQogICAgfQogIH0KfQo="},{"version":3,"sources":["cart.vue"],"names":[],"mappings":";AA8WA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"cart.vue","sourceRoot":"src/pages","sourcesContent":["<template>\n  <div class=\"cart\">\n    <order-header title=\"我的购物车\">\n      <template v-slot:tip>\n        <span>温馨提示：产品是否购买成功，以最终下单为准哦，请尽快结算</span>\n      </template>\n    </order-header>\n    <div class=\"wrapper\">\n      <div class=\"container\">\n        <div class=\"cart-box\">\n          <ul class=\"cart-item-head\">\n            <li class=\"col-1\"><span class=\"checkbox\" v-bind:class=\"{'checked':allChecked}\" @click=\"toggleAll\"></span>全选</li>\n            <li class=\"col-3\">商品名称</li>\n            <li class=\"col-1\">单价</li>\n            <li class=\"col-2\">数量</li>\n            <li class=\"col-1\">小计</li>\n            <li class=\"col-1\">操作</li>\n          </ul>\n          <ul class=\"cart-item-list\">\n            <li class=\"cart-item\" v-for=\"(item,index) in list\" v-bind:key=\"index\">\n              <div class=\"item-check\">\n                <span class=\"checkbox\"     v-bind:class=\"{'checked':item.productSelected}\"      @click=\"updateCart(item)\"></span>\n              </div>\n              <div class=\"item-name\">\n                <img v-lazy=\"item.productPic\" alt=\"\">\n                <span>{{item.productName + ' , ' + item.productSubTitle}}</span>\n              </div>\n              <div class=\"item-price\">{{item.price}}</div>\n              <div class=\"item-num\">\n                <div class=\"num-box\">\n                  <a href=\"javascript:;\" @click=\"updateCart(item,'-')\">-</a>\n                  <span >{{item.quantity}}</span>\n                  <a href=\"javascript:;\"  @click=\"updateCart(item,'+')\">+</a>\n                </div>\n                <div>当前库存：{{item.stock}}</div>\n              </div>\n              <div class=\"item-total\">{{item.quantity*item.price}}</div>\n              <div class=\"item-del\" @click=\"delProduct(item)\"></div>\n            </li>\n          </ul>\n        </div>\n        <div class=\"order-wrap clearfix\">\n          <div class=\"cart-tip fl\">\n            <a href=\"/#/index\">继续购物</a>\n            共<span>{{list.length}}</span>件商品，已选择<span>{{checkedNum}}</span>件，总价<span>{{calcSum}}</span>\n          </div>\n          <div class=\"total fr\">\n             <a href=\"javascript:;\" class=\"btn\" @click=\"order\">去结算</a>\n          </div>\n        </div>\n      </div>\n    </div>\n    <service-bar></service-bar>\n    <nav-footer></nav-footer>\n  </div>\n</template>\n<script>\n  import OrderHeader from './../components/OrderHeader'\n  import ServiceBar from './../components/ServiceBar'\n  import NavFooter from './../components/NavFooter'\n  import Qs from 'qs'\n  import constStore from './../store/constStore.js'\n  export default{\n    name:'index',\n    components:{\n      OrderHeader,\n      ServiceBar,\n      NavFooter\n    },\n    data(){\n      return {\n        list:[],//商品列表\n        allChecked:false,//是否全选\n        cartTotalPrice:0,//商品总金额\n        checkedNum:0//选中商品数量\n      }\n    }, \n    computed:{\n      calcSum(){\n        let sum=0;\n            this.list.map((item)=>{\n              // 是否选中\n               if(item.productSelected){\n                  sum+=item.price*item.quantity\n                }\n             });\n        return sum;\n      }\n    },\n    mounted(){\n      this.getCartList();\n    },\n    methods:{\n      // 获取购物车列表\n      getCartList(){\n        this.axios.get('/car/list').then((res)=>{\n          this.renderData(res);\n        })\n      },\n      // 更新购物车数量和购物车单选状态\n      updateCart(item,type){\n        let quantity = item.quantity;\n            //selected = item.productSelected;\n        if(type == '-'){\n          if(quantity == 1){\n            this.$message.warning('商品至少保留一件');\n            return;\n          }\n           --quantity;\n            item.quantity=quantity;\n          this.axios.post('/car/update/quantity',Qs.stringify({\n            id:item.id,\n            quantity:item.quantity\n          }),{headers: {'Content-Type': 'application/x-www-form-urlencoded'}}).then(()=>{\n           });\n        }else if(type == '+'){\n          // 如果当前数量等于库存就不能再加\n          if(quantity>=item.stock){\n            this.$message.warning('库存不足！');\n            return;\n          }\n\n            ++quantity; \n            item.quantity=quantity;\n         \n          this.axios.post('/car/update/quantity',Qs.stringify({\n            id:item.id,\n            quantity:item.quantity\n          }),{headers: {'Content-Type': 'application/x-www-form-urlencoded'}}).then(()=>{\n           });\n\n\n        }else{\n        // 选择\n        if(quantity>item.stock){\n            this.$message.warning('库存不足！');\n            return;\n          }\n\n         var index=0;\n         this.list.map((oitem)=>{\n               if(oitem.id==item.id){\n                   oitem.productSelected = !oitem.productSelected;\n\n                   if(oitem.productSelected){\n                     this.checkedNum++; \n                   }else{\n                     this.checkedNum--;\n                   }\n                     this.$set(this.list,index,oitem);\n               }\n          index++;\n         });\n        }\n      },\n       // 删除购物车商品\n      delProduct(item){\n          this.axios.post('/car/delete',Qs.stringify({\n            ids:item.id\n          }),{headers: {'Content-Type': 'application/x-www-form-urlencoded'}}).then(()=>{\n            this.$message.success('删除成功');\n            var index=0;\n            var target=0;\n            this.list.map((oitem)=>{\n                if(oitem.id==item.id){\n                   target=index;  \n                }\n                 index++;\n            });\n            this.checkedNum--;\n            this.list.splice(target,1);\n\n          });\n\n\n      },\n      // 控制全选功能\n      toggleAll(){\n           this.list.map((item)=>{\n             // 为每个项设置productSelected \n             if(item.quantity>item.stock){\n              this.$message.warning('库存不足！');\n              return;\n             }\n               item.productSelected=!this.allChecked;\n           });\n         this.allChecked=!this.allChecked;\n         if(this.allChecked){\n           this.checkedNum=this.list.length;\n         }else{\n           this.checkedNum=0;\n         }\n      },\n      // 公共赋值\n      renderData(res){\n        this.list =  res; \n        \n        this.list.map((item)=>{\n          if(item.productSelected==undefined){\n              item.productSelected=false;\n          }\n        }); \n\n        //this.list.filter(item=>item.productSelected).length;\n      },\n      // 购物车下单\n      order(){\n          let isCheck = this.list.every(item=>!item.productSelected);\n           \n       if(isCheck){\n          this.$message.warning('请选择一件商品');\n        }else{\n            constStore.itemids=[];\n            this.list.map((item)=>{\n              // 如果选中\n               if(item.productSelected){\n                 // 当前购物车id\n                 constStore.itemids.push(item.id);\n                }\n             });\n             // 替换路由：不会刷新页面 会保留根vue对象中的值 ， 跳转页面： 重新加载会创建创建vue对象\n             this.$router.push('/order/confirm');\n        }\n      }\n    },\n  }\n</script>\n<style lang=\"scss\">\n  .cart{\n    .wrapper{\n      background-color:#F5F5F5;\n      padding-top:30px;\n      padding-bottom:114px;\n      .cart-box{\n        background-color:#fff;\n        font-size:14px;\n        color:#999999;\n        text-align:center;\n        .checkbox{\n          display: inline-block;\n          width: 22px;\n          height: 22px;\n          border: 1px solid #E5E5E5;\n          vertical-align: middle;\n          margin-right: 17px;\n          cursor:pointer;\n          &.checked{\n            background:url('/imgs/icon-gou.png') #FF6600 no-repeat center;\n            background-size:16px 12px;\n            border:none;\n          }\n        }\n        .cart-item-head{\n          display:flex;\n          height: 79px;\n          line-height: 79px;\n          .col-1{\n            flex:1;\n          }\n          .col-2{\n            flex:2;\n          }\n          .col-3{\n            flex:3;\n          }\n        }\n        .cart-item-list{\n          .cart-item{\n            display:flex;\n            align-items:center;\n            height:125px;\n            border-top:1px solid #E5E5E5;\n            font-size:16px;\n            .item-check{\n              flex:1;\n            }\n            .item-name{\n              flex:3;\n              font-size: 18px;\n              color: #333333;\n              display: flex;\n              align-items: center;\n              img{\n                width:80px;\n                height:80px;\n                vertical-align:middle;\n              }\n              span{\n                margin-left: 30px;\n              }\n            }\n            .item-price{\n              flex:1;\n              color:#333333;\n            }\n            .item-num{\n              flex:2;\n              .num-box{\n                display:inline-block;\n                width:150px;\n                height:40px;\n                line-height:40px;\n                border:1px solid #E5E5E5;\n                font-size:14px;\n                a{\n                  display:inline-block;\n                  width:50px;\n                  color:#333333;\n                }\n                span{\n                  display:inline-block;\n                  width:50px;\n                  color:#333333;\n                }\n              }\n            }\n            .item-total{\n              flex:1;\n              color:#FF6600;\n            }\n            .item-del{\n              flex:1;\n              width:14px;\n              height:12px;\n              background:url('/imgs/icon-close.png') no-repeat center;\n              background-size:contain;\n              cursor:pointer;\n            }\n          }\n        }\n      }\n      .order-wrap{\n        font-size:14px;\n        color: #666666;\n        margin-top: 20px;\n        height: 50px;\n        line-height: 50px;\n        .cart-tip{\n          margin-left: 29px;\n          a{\n            color: #666666;\n            margin-right:37px;\n          }\n          span{\n            color:#FF6600;\n            margin:0 5px;\n          }\n        }\n        .total{\n          font-size:14px;\n          color:#FF6600;\n          span{\n            font-size:24px;\n          }\n          a{\n            width:202px;\n            height:50px;\n            line-height:50px;\n            font-size:18px;\n            margin-left:37px;\n          }\n        }\n      }\n    }\n  }\n</style>"]}]}