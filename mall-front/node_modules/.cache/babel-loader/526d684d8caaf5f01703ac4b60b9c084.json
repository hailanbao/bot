{"remainingRequest":"F:\\developer\\mall_sys\\mall-front\\node_modules\\babel-loader\\lib\\index.js!F:\\developer\\mall_sys\\mall-front\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!F:\\developer\\mall_sys\\mall-front\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\developer\\mall_sys\\mall-front\\src\\pages\\orderPay.vue?vue&type=script&lang=js","dependencies":[{"path":"F:\\developer\\mall_sys\\mall-front\\src\\pages\\orderPay.vue","mtime":1617719626000},{"path":"F:\\developer\\mall_sys\\mall-front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\developer\\mall_sys\\mall-front\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"F:\\developer\\mall_sys\\mall-front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\developer\\mall_sys\\mall-front\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IFFSQ29kZSBmcm9tICdxcmNvZGUnOwppbXBvcnQgT3JkZXJIZWFkZXIgZnJvbSAnLi8uLi9jb21wb25lbnRzL09yZGVySGVhZGVyJzsKaW1wb3J0IFNjYW5QYXlDb2RlIGZyb20gJy4vLi4vY29tcG9uZW50cy9TY2FuUGF5Q29kZSc7CmltcG9ydCBNb2RhbCBmcm9tICcuLy4uL2NvbXBvbmVudHMvTW9kYWwnOwppbXBvcnQgUXMgZnJvbSAncXMnOwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogJ29yZGVyLXBheScsCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIG9yZGVySWQ6IHRoaXMuJHJvdXRlLnF1ZXJ5Lm9yZGVySWQsCiAgICAgIGFkZHJlc3NJbmZvOiAnJywKICAgICAgLy/mlLbotKfkurrlnLDlnYAKICAgICAgb3JkZXJEZXRhaWw6IFtdLAogICAgICAvL+iuouWNleivpuaDhe+8jOWMheWQq+WVhuWTgeWIl+ihqAogICAgICBzaG93RGV0YWlsOiBmYWxzZSwKICAgICAgLy/mmK/lkKbmmL7npLrorqLljZXor6bmg4UKICAgICAgcGF5VHlwZTogJycsCiAgICAgIC8v5pSv5LuY57G75Z6LCiAgICAgIHNob3dQYXk6IGZhbHNlLAogICAgICAvL+aYr+WQpuaYvuekuuW+ruS/oeaUr+S7mOW8ueahhgogICAgICBwYXlJbWc6ICcnLAogICAgICAvL+W+ruS/oeaUr+S7mOeahOS6jOe7tOeggeWcsOWdgAogICAgICBzaG93UGF5TW9kYWw6IGZhbHNlLAogICAgICAvL+aYr+WQpuaYvuekuuS6jOasoeaUr+S7mOehruiupOW8ueahhgogICAgICBwYXltZW50OiAwLAogICAgICAvL+iuouWNleaAu+mHkeminQogICAgICBUOiAnJywKICAgICAgLy/lrprml7blmahJRAogICAgICBwYXlJbWFnZVFyOiAnJywKICAgICAgb3JkZXJTbjogJycsCiAgICAgIG9yZGVyT3ZlcnRpbWU6ICcnCiAgICB9OwogIH0sCiAgY29tcG9uZW50czogewogICAgT3JkZXJIZWFkZXIsCiAgICBTY2FuUGF5Q29kZSwKICAgIE1vZGFsCiAgfSwKICBtb3VudGVkKCkgewogICAgdGhpcy5nZXRPcmRlckRldGFpbCgpOwogIH0sCiAgbWV0aG9kczogewogICAgZ2V0T3JkZXJEZXRhaWwoKSB7CiAgICAgIHRoaXMuYXhpb3MuZ2V0KGAvb3JkZXIvb3JkZXJEZXRhaWw/b3JkZXJJZD0ke3RoaXMub3JkZXJJZH1gKS50aGVuKHJlcyA9PiB7CiAgICAgICAgdGhpcy5vcmRlckRldGFpbCA9IHJlcy5vcmRlckl0ZW1MaXN0OyAvL+iuouWNleWVhuWTgeivpuaDhQogICAgICAgIHRoaXMuYWRkcmVzc0luZm8gPSByZXMucmVjZWl2ZXJQcm92aW5jZSArIHJlcy5yZWNlaXZlckNpdHkgKyByZXMucmVjZWl2ZXJSZWdpb24gKyByZXMucmVjZWl2ZXJEZXRhaWxBZGRyZXNzOwogICAgICAgIHRoaXMucGF5bWVudCA9IHJlcy5wYXlBbW91bnQ7CiAgICAgICAgdGhpcy5vcmRlclNuID0gcmVzLm9yZGVyU247CiAgICAgICAgdGhpcy5vcmRlck92ZXJ0aW1lID0gcmVzLm5vcm1hbE9yZGVyT3ZlcnRpbWU7CiAgICAgIH0pOwogICAgfSwKICAgIHBheVN1Ym1pdChwYXlUeXBlKSB7CiAgICAgIHRoaXMucGF5VHlwZSA9IHBheVR5cGU7CiAgICAgIHRoaXMuc2hvd1BheSA9ICF0aGlzLnNob3dQYXk7CiAgICAgIC8vIOaUr+S7mOWunQogICAgICBpZiAocGF5VHlwZSA9PSAxKSB7CiAgICAgICAgdGhpcy5heGlvcy5wb3N0KCcvb3JkZXIvdHJhZGVRckNvZGUnLCBRcy5zdHJpbmdpZnkoewogICAgICAgICAgb3JkZXJJZDogdGhpcy5vcmRlcklkLAogICAgICAgICAgcGF5VHlwZTogMQogICAgICAgIH0pLCB7CiAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkJwogICAgICAgICAgfQogICAgICAgIH0pLnRoZW4ocmVzID0+IHsKICAgICAgICAgIHRoaXMucGF5SW1hZ2VRciA9ICdodHRwOi8vbG9jYWxob3N0Ojg4ODgnICsgcmVzOwogICAgICAgICAgd2luZG93LmNvbnNvbGUubG9nKHJlcyk7CiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8g5b6u5L+hCiAgICAgICAgdGhpcy5heGlvcy5wb3N0KCcvcGF5JywgewogICAgICAgICAgb3JkZXJJZDogdGhpcy5vcmRlcklkLAogICAgICAgICAgb3JkZXJOYW1lOiAn5Zu+54G15ZWG5Z+O5Z+656GA54mIJywKICAgICAgICAgIGFtb3VudDogMC4wMSwKICAgICAgICAgIC8v5Y2V5L2N5YWDCiAgICAgICAgICBwYXlUeXBlOiAyIC8vMeaUr+S7mOWune+8jDLlvq7kv6EKICAgICAgICB9KS50aGVuKHJlcyA9PiB7CiAgICAgICAgICBRUkNvZGUudG9EYXRhVVJMKHJlcy5jb250ZW50KS50aGVuKHVybCA9PiB7CiAgICAgICAgICAgIHRoaXMuc2hvd1BheSA9IHRydWU7CiAgICAgICAgICAgIHRoaXMucGF5SW1nID0gdXJsOwogICAgICAgICAgICB0aGlzLmxvb3BPcmRlclN0YXRlKCk7CiAgICAgICAgICB9KS5jYXRjaCgoKSA9PiB7CiAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoJ+W+ruS/oeS6jOe7tOeggeeUn+aIkOWksei0pe+8jOivt+eojeWQjumHjeivlScpOwogICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0sCiAgICAvLyDlhbPpl63lvq7kv6HlvLnmoYYKICAgIGNsb3NlUGF5TW9kYWwoKSB7CiAgICAgIHRoaXMuc2hvd1BheSA9IGZhbHNlOwogICAgICB0aGlzLnNob3dQYXlNb2RhbCA9IHRydWU7CiAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy5UKTsKICAgIH0sCiAgICAvLyDova7or6LlvZPliY3orqLljZXmlK/ku5jnirbmgIEKICAgIGxvb3BPcmRlclN0YXRlKCkgewogICAgICB0aGlzLlQgPSBzZXRJbnRlcnZhbCgoKSA9PiB7CiAgICAgICAgdGhpcy5heGlvcy5nZXQoYC9vcmRlcnMvJHt0aGlzLm9yZGVySWR9YCkudGhlbihyZXMgPT4gewogICAgICAgICAgaWYgKHJlcy5zdGF0dXMgPT0gMjApIHsKICAgICAgICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLlQpOwogICAgICAgICAgICB0aGlzLmdvT3JkZXJMaXN0KCk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0sIDEwMDApOwogICAgfSwKICAgIGdvT3JkZXJMaXN0KCkgewogICAgICB0aGlzLiRyb3V0ZXIucHVzaCgnL29yZGVyL2xpc3QnKTsKICAgIH0KICB9Cn07"},{"version":3,"names":["QRCode","OrderHeader","ScanPayCode","Modal","Qs","name","data","orderId","$route","query","addressInfo","orderDetail","showDetail","payType","showPay","payImg","showPayModal","payment","T","payImageQr","orderSn","orderOvertime","components","mounted","getOrderDetail","methods","axios","get","then","res","orderItemList","receiverProvince","receiverCity","receiverRegion","receiverDetailAddress","payAmount","normalOrderOvertime","paySubmit","post","stringify","headers","window","console","log","orderName","amount","toDataURL","content","url","loopOrderState","catch","$message","error","closePayModal","clearInterval","setInterval","status","goOrderList","$router","push"],"sources":["src/pages/orderPay.vue"],"sourcesContent":["<template>\n  <div class=\"order-pay\">\n    <order-header title=\"订单支付\">\n      <template v-slot:tip>\n        <span>请谨防钓鱼链接或诈骗电话，了解更多</span>\n      </template>\n    </order-header>\n    <div class=\"wrapper\">\n      <div class=\"container\">\n        <div class=\"order-wrap\">\n          <div class=\"item-order\">\n            <div class=\"icon-succ\"></div>\n            <div class=\"order-info\">\n              <h2>订单提交成功！去付款咯～</h2>\n              <p>请在<span>{{orderOvertime}}分</span>内完成支付, 超时后将取消订单</p>\n              <p>收货信息：{{addressInfo}}</p>\n            </div>\n            <div class=\"order-total\">\n              <p>应付总额：<span>{{payment}}</span>元</p>\n              <p>订单详情<em class=\"icon-down\" :class=\"{'up':showDetail}\" @click=\"showDetail=!showDetail\"></em></p>\n            </div>\n          </div>\n          <div class=\"item-detail\" v-if=\"showDetail\">\n            <div class=\"item\">\n              <div class=\"detail-title\">订单号：</div>\n              <div class=\"detail-info theme-color\">{{orderSn}}</div>\n            </div>\n            <div class=\"item\">\n              <div class=\"detail-title\">收货信息：</div>\n              <div class=\"detail-info\">{{addressInfo}}</div>\n            </div>\n            <div class=\"item good\">\n              <div class=\"detail-title\">商品名称：</div>\n              <div class=\"detail-info\">\n                <ul>\n                  <li v-for=\"(item,index) in orderDetail\" :key=\"index\">\n                    <img v-lazy=\"item.productPic\"/>{{item.productName}}\n                  </li>\n                </ul>\n              </div>\n            </div>\n            <!-- <div class=\"item\">\n              <div class=\"detail-title\">发票信息：</div>\n              <div class=\"detail-info\">电子发票 个人</div>\n            </div> -->\n          </div>\n        </div>\n        <div class=\"item-pay\">\n          <h3>选择以下支付方式付款</h3>\n          <div class=\"pay-way\">\n            <p>支付平台</p>\n            <div class=\"pay pay-ali\" @click=\"paySubmit(1)\" :class=\"{'checked':payType==1}\"></div>\n            <div class=\"pay pay-wechat\" :class=\"{'checked':payType==2}\" ></div>\n          </div>\n           <div class=\"pay-way\"  v-if=\"showPay && payType==1\" >\n              <img  :src=\"payImageQr\"/>\n            </div>\n        </div>\n      </div>\n    </div>\n    <scan-pay-code v-if=\"showPay && payType==2\" @close=\"closePayModal\" :img=\"payImg\"></scan-pay-code>\n    <modal\n      title=\"支付确认\"\n      btnType=\"3\"\n      :showModal=\"showPayModal\"\n      sureText=\"查看订单\"\n      cancelText=\"未支付\"\n      @cancel=\"showPayModal=false\"\n      @submit=\"goOrderList\"\n    >\n      <template v-slot:body>\n        <p>您确认是否完成支付？</p>\n      </template>\n    </modal>\n  </div>\n</template>\n<script>\nimport QRCode from 'qrcode'\nimport OrderHeader from './../components/OrderHeader'\nimport ScanPayCode from './../components/ScanPayCode'\nimport Modal from './../components/Modal'\nimport Qs from 'qs'\nexport default{\n  name:'order-pay',\n  data(){\n    return {\n      orderId:this.$route.query.orderId,\n      addressInfo:'',//收货人地址\n      orderDetail:[],//订单详情，包含商品列表\n      showDetail:false,//是否显示订单详情\n      payType:'',//支付类型\n      showPay:false,//是否显示微信支付弹框\n      payImg:'',//微信支付的二维码地址\n      showPayModal:false,//是否显示二次支付确认弹框\n      payment:0,//订单总金额\n      T:'',//定时器ID\n      payImageQr:'', \n      orderSn:'',\n      orderOvertime:'',\n    }\n  },\n  components:{\n    OrderHeader,\n    ScanPayCode,\n    Modal\n  },\n  mounted(){\n    this.getOrderDetail();\n  },\n  methods:{\n    getOrderDetail(){\n      this.axios.get(`/order/orderDetail?orderId=${this.orderId}`).then((res)=>{\n         this.orderDetail=res.orderItemList;  //订单商品详情\n         this.addressInfo=res.receiverProvince+res.receiverCity+res.receiverRegion+res.receiverDetailAddress;\n         this.payment=res.payAmount;\n         this.orderSn=res.orderSn;\n         this.orderOvertime=res.normalOrderOvertime;\n\n      }) \n    },\n    paySubmit(payType){\n      this.payType=payType;\n      this.showPay = !this.showPay;\n      // 支付宝\n      if(payType == 1){ \n          this.axios.post('/order/tradeQrCode',Qs.stringify({\n          orderId:this.orderId,\n          payType:1\n        }),{headers: {'Content-Type': 'application/x-www-form-urlencoded'}}).then((res)=>{\n        this.payImageQr='http://localhost:8888'+res;\n        window.console.log(res);\n        })\n      }else{\n        // 微信\n        this.axios.post('/pay',{\n          orderId:this.orderId,\n          orderName:'图灵商城基础版',\n          amount:0.01,//单位元\n          payType:2 //1支付宝，2微信\n        }).then((res)=>{\n          QRCode.toDataURL(res.content)\n          .then(url => {\n            this.showPay = true;\n            this.payImg = url;\n            this.loopOrderState();\n          })\n          .catch(() => {\n            this.$message.error('微信二维码生成失败，请稍后重试');\n          })\n        })\n      }\n    },\n    // 关闭微信弹框\n    closePayModal(){\n      this.showPay = false;\n      this.showPayModal = true;\n      clearInterval(this.T);\n    },\n    // 轮询当前订单支付状态\n    loopOrderState(){\n      this.T = setInterval(()=>{\n        this.axios.get(`/orders/${this.orderId}`).then((res)=>{\n          if(res.status == 20){\n            clearInterval(this.T);\n            this.goOrderList();\n          }\n        })\n      },1000);\n    },\n    goOrderList(){\n      this.$router.push('/order/list');\n    }\n  }\n}\n</script>\n<style lang=\"scss\">\n  .order-pay{\n    .wrapper{\n      background-color:#F5F5F5;\n      padding-top:30px;\n      padding-bottom:61px;\n      .order-wrap{\n        padding: 62px 50px;\n        background-color: #fff;\n        font-size:14px;\n        margin-bottom:30px;\n        .item-order{\n          display: flex;\n          align-items: center;\n          .icon-succ{\n            width: 90px;\n            height: 90px;\n            border-radius: 50%;\n            background:url('/imgs/icon-gou.png') #80c58a no-repeat center;\n            background-size:60px;\n            margin-right:40px;\n          }\n          .order-info{\n            margin-right: 248px;\n            h2{\n              font-size:24px;\n              color:#333333;\n              margin-bottom:20px;\n            }\n            p{\n              color:#666666;\n              span{\n                color:#FF6700;\n              }\n            }\n          }\n          .order-total{\n            &>p:first-child{\n              margin-bottom:30px;\n            }\n            span{\n              font-size:28px;\n              color:#FF6700;\n            }\n            .icon-down{\n              display:inline-block;\n              width:14px;\n              height:10px;\n              background:url('/imgs/icon-down.png') no-repeat center;\n              background-size:contain;\n              margin-left:9px;\n              transition:all .5s;\n              cursor:pointer;\n              &.up{\n                transform: rotate(180deg);\n              }\n            }\n            .icon-up{\n              transform: rotate(180deg);\n            }\n          }\n        }\n        .item-detail{\n          border-top: 1px solid #D7D7D7;\n          padding-top: 47px;\n          padding-left: 130px;\n          font-size: 14px;\n          margin-top: 45px;\n          .item{\n            margin-bottom:19px;\n            .detail-title{\n              float:left;\n              width:100px;\n            }\n            .detail-info{\n              display:inline-block;\n              img{\n                width: 30px;\n                vertical-align: middle;\n              }\n            }\n          }\n        }\n      }\n      .item-pay{\n        padding:26px 50px 72px;\n        background-color:#ffffff;\n        color: #333333;\n        h3{\n          font-size: 20px;\n          font-weight: 200;\n          color: #333333;\n          padding-bottom: 24px;\n          border-bottom: 1px solid #D7D7D7;\n          margin-bottom: 26px;\n        }\n        .pay-way{\n          font-size:18px;\n          .pay{\n            display:inline-block;\n            width:188px;\n            height:64px;\n            border:1px solid #D7D7D7;\n            cursor:pointer;\n            &:last-child{\n              margin-left:20px;\n            }\n            &.checked{\n              border:1px solid #FF6700;\n            }\n          }\n          .pay-ali{\n            background:url('/imgs/pay/icon-ali.png') no-repeat center;\n            background-size:103px 38px;\n            margin-top:19px;\n          }\n          .pay-wechat{\n            background:url('/imgs/pay/icon-wechat.png') no-repeat center;\n            background-size:103px 38px;\n          }\n        }\n      }\n    }\n  }\n</style>"],"mappings":"AA6EA,OAAAA,MAAA;AACA,OAAAC,WAAA;AACA,OAAAC,WAAA;AACA,OAAAC,KAAA;AACA,OAAAC,EAAA;AACA;EACAC,IAAA;EACAC,KAAA;IACA;MACAC,OAAA,OAAAC,MAAA,CAAAC,KAAA,CAAAF,OAAA;MACAG,WAAA;MAAA;MACAC,WAAA;MAAA;MACAC,UAAA;MAAA;MACAC,OAAA;MAAA;MACAC,OAAA;MAAA;MACAC,MAAA;MAAA;MACAC,YAAA;MAAA;MACAC,OAAA;MAAA;MACAC,CAAA;MAAA;MACAC,UAAA;MACAC,OAAA;MACAC,aAAA;IACA;EACA;EACAC,UAAA;IACArB,WAAA;IACAC,WAAA;IACAC;EACA;EACAoB,QAAA;IACA,KAAAC,cAAA;EACA;EACAC,OAAA;IACAD,eAAA;MACA,KAAAE,KAAA,CAAAC,GAAA,oCAAApB,OAAA,IAAAqB,IAAA,CAAAC,GAAA;QACA,KAAAlB,WAAA,GAAAkB,GAAA,CAAAC,aAAA;QACA,KAAApB,WAAA,GAAAmB,GAAA,CAAAE,gBAAA,GAAAF,GAAA,CAAAG,YAAA,GAAAH,GAAA,CAAAI,cAAA,GAAAJ,GAAA,CAAAK,qBAAA;QACA,KAAAjB,OAAA,GAAAY,GAAA,CAAAM,SAAA;QACA,KAAAf,OAAA,GAAAS,GAAA,CAAAT,OAAA;QACA,KAAAC,aAAA,GAAAQ,GAAA,CAAAO,mBAAA;MAEA;IACA;IACAC,UAAAxB,OAAA;MACA,KAAAA,OAAA,GAAAA,OAAA;MACA,KAAAC,OAAA,SAAAA,OAAA;MACA;MACA,IAAAD,OAAA;QACA,KAAAa,KAAA,CAAAY,IAAA,uBAAAlC,EAAA,CAAAmC,SAAA;UACAhC,OAAA,OAAAA,OAAA;UACAM,OAAA;QACA;UAAA2B,OAAA;YAAA;UAAA;QAAA,GAAAZ,IAAA,CAAAC,GAAA;UACA,KAAAV,UAAA,6BAAAU,GAAA;UACAY,MAAA,CAAAC,OAAA,CAAAC,GAAA,CAAAd,GAAA;QACA;MACA;QACA;QACA,KAAAH,KAAA,CAAAY,IAAA;UACA/B,OAAA,OAAAA,OAAA;UACAqC,SAAA;UACAC,MAAA;UAAA;UACAhC,OAAA;QACA,GAAAe,IAAA,CAAAC,GAAA;UACA7B,MAAA,CAAA8C,SAAA,CAAAjB,GAAA,CAAAkB,OAAA,EACAnB,IAAA,CAAAoB,GAAA;YACA,KAAAlC,OAAA;YACA,KAAAC,MAAA,GAAAiC,GAAA;YACA,KAAAC,cAAA;UACA,GACAC,KAAA;YACA,KAAAC,QAAA,CAAAC,KAAA;UACA;QACA;MACA;IACA;IACA;IACAC,cAAA;MACA,KAAAvC,OAAA;MACA,KAAAE,YAAA;MACAsC,aAAA,MAAApC,CAAA;IACA;IACA;IACA+B,eAAA;MACA,KAAA/B,CAAA,GAAAqC,WAAA;QACA,KAAA7B,KAAA,CAAAC,GAAA,iBAAApB,OAAA,IAAAqB,IAAA,CAAAC,GAAA;UACA,IAAAA,GAAA,CAAA2B,MAAA;YACAF,aAAA,MAAApC,CAAA;YACA,KAAAuC,WAAA;UACA;QACA;MACA;IACA;IACAA,YAAA;MACA,KAAAC,OAAA,CAAAC,IAAA;IACA;EACA;AACA"}]}